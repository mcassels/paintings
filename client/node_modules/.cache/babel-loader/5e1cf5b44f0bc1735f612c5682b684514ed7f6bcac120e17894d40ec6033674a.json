{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useQuery } from \"@tanstack/react-query\";\nconst paintingsTableUrl = \"https://api.airtable.com/v0/app2HxNPQejnLR2g0/tblAePvviV6Sd00Ez\";\nasync function fetchPaintings() {\n  const response = await fetch(paintingsTableUrl, {\n    headers: {\n      Authorization: `Bearer ${process.env.REACT_APP_AIRTABLE_TOKEN}`\n    }\n  });\n  const data = await response.json();\n  const paintings = [];\n  for (const record of data.records) {\n    const photos = record.fields.photo;\n    if (!photos || photos.length !== 1) {\n      // Each painting must have exactly one primary photo. TODO: do we want multiple photos per painting?\n      continue;\n    }\n    const photo = {\n      url: photos[0].url,\n      height: photos[0].height,\n      width: photos[0].width\n    };\n    const painting = {\n      id: record.fields.painting_number,\n      photo,\n      year: record.fields.year,\n      name: record.fields.name,\n      size: record.fields.size,\n      status: record.fields.status,\n      conditionNotes: record.fields.condition_notes,\n      isFramed: record.fields.framed,\n      medium: record.fields.medium\n    };\n    paintings.push(painting);\n  }\n  return paintings;\n}\nexport function usePaintings() {\n  _s();\n  const {\n    isLoading,\n    isError,\n    data\n  } = useQuery({\n    queryKey: ['paintings'],\n    queryFn: fetchPaintings,\n    // This query should only be made once per session!\n    // Never need to refetch this.\n    staleTime: Infinity,\n    retry: false\n  });\n  if (isLoading) {\n    return 'loading';\n  }\n  if (isError) {\n    return 'error';\n  }\n  return data || 'error';\n}\n_s(usePaintings, \"q1ofiQvR8Bn/xrUmbEB+rJ2Sqs8=\", false, function () {\n  return [useQuery];\n});","map":{"version":3,"names":["useQuery","paintingsTableUrl","fetchPaintings","response","fetch","headers","Authorization","process","env","REACT_APP_AIRTABLE_TOKEN","data","json","paintings","record","records","photos","fields","photo","length","url","height","width","painting","id","painting_number","year","name","size","status","conditionNotes","condition_notes","isFramed","framed","medium","push","usePaintings","_s","isLoading","isError","queryKey","queryFn","staleTime","Infinity","retry"],"sources":["/Users/morgan/dev/paintings/src/usePaintings.ts"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport { Painting, PaintingsResponse, Photo } from \"./types\";\n\nconst paintingsTableUrl = \"https://api.airtable.com/v0/app2HxNPQejnLR2g0/tblAePvviV6Sd00Ez\";\n\nasync function fetchPaintings(): Promise<Painting[]> {\n  const response = await fetch(\n    paintingsTableUrl,\n    { headers: { Authorization: `Bearer ${process.env.REACT_APP_AIRTABLE_TOKEN}` }},\n  );\n\n  const data = await response.json();\n  const paintings: Painting[] = [];\n\n  for (const record of data.records) {\n    const photos = record.fields.photo;\n    if (!photos || photos.length !== 1) { // Each painting must have exactly one primary photo. TODO: do we want multiple photos per painting?\n      continue;\n    }\n    const photo: Photo = {\n      url: photos[0].url,\n      height: photos[0].height,\n      width: photos[0].width,\n    }\n\n    const painting: Painting = {\n      id: record.fields.painting_number,\n      photo,\n      year: record.fields.year,\n      name: record.fields.name,\n      size: record.fields.size,\n      status: record.fields.status,\n      conditionNotes: record.fields.condition_notes,\n      isFramed: record.fields.framed,\n      medium: record.fields.medium,\n    };\n    paintings.push(painting);\n  }\n  return paintings;\n}\n\nexport function usePaintings(): PaintingsResponse {\n  const {\n    isLoading,\n    isError,\n    data,\n  } = useQuery({\n    queryKey: ['paintings'],\n    queryFn: fetchPaintings,\n    // This query should only be made once per session!\n    // Never need to refetch this.\n    staleTime: Infinity,\n    retry: false,\n  });\n\n  if (isLoading) {\n    return 'loading';\n  }\n  if (isError) {\n    return 'error';\n  }\n\n  return data || 'error';\n}"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,uBAAuB;AAGhD,MAAMC,iBAAiB,GAAG,iEAAiE;AAE3F,eAAeC,cAAcA,CAAA,EAAwB;EACnD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAC1BH,iBAAiB,EACjB;IAAEI,OAAO,EAAE;MAAEC,aAAa,EAAG,UAASC,OAAO,CAACC,GAAG,CAACC,wBAAyB;IAAE;EAAC,CAChF,CAAC;EAED,MAAMC,IAAI,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;EAClC,MAAMC,SAAqB,GAAG,EAAE;EAEhC,KAAK,MAAMC,MAAM,IAAIH,IAAI,CAACI,OAAO,EAAE;IACjC,MAAMC,MAAM,GAAGF,MAAM,CAACG,MAAM,CAACC,KAAK;IAClC,IAAI,CAACF,MAAM,IAAIA,MAAM,CAACG,MAAM,KAAK,CAAC,EAAE;MAAE;MACpC;IACF;IACA,MAAMD,KAAY,GAAG;MACnBE,GAAG,EAAEJ,MAAM,CAAC,CAAC,CAAC,CAACI,GAAG;MAClBC,MAAM,EAAEL,MAAM,CAAC,CAAC,CAAC,CAACK,MAAM;MACxBC,KAAK,EAAEN,MAAM,CAAC,CAAC,CAAC,CAACM;IACnB,CAAC;IAED,MAAMC,QAAkB,GAAG;MACzBC,EAAE,EAAEV,MAAM,CAACG,MAAM,CAACQ,eAAe;MACjCP,KAAK;MACLQ,IAAI,EAAEZ,MAAM,CAACG,MAAM,CAACS,IAAI;MACxBC,IAAI,EAAEb,MAAM,CAACG,MAAM,CAACU,IAAI;MACxBC,IAAI,EAAEd,MAAM,CAACG,MAAM,CAACW,IAAI;MACxBC,MAAM,EAAEf,MAAM,CAACG,MAAM,CAACY,MAAM;MAC5BC,cAAc,EAAEhB,MAAM,CAACG,MAAM,CAACc,eAAe;MAC7CC,QAAQ,EAAElB,MAAM,CAACG,MAAM,CAACgB,MAAM;MAC9BC,MAAM,EAAEpB,MAAM,CAACG,MAAM,CAACiB;IACxB,CAAC;IACDrB,SAAS,CAACsB,IAAI,CAACZ,QAAQ,CAAC;EAC1B;EACA,OAAOV,SAAS;AAClB;AAEA,OAAO,SAASuB,YAAYA,CAAA,EAAsB;EAAAC,EAAA;EAChD,MAAM;IACJC,SAAS;IACTC,OAAO;IACP5B;EACF,CAAC,GAAGV,QAAQ,CAAC;IACXuC,QAAQ,EAAE,CAAC,WAAW,CAAC;IACvBC,OAAO,EAAEtC,cAAc;IACvB;IACA;IACAuC,SAAS,EAAEC,QAAQ;IACnBC,KAAK,EAAE;EACT,CAAC,CAAC;EAEF,IAAIN,SAAS,EAAE;IACb,OAAO,SAAS;EAClB;EACA,IAAIC,OAAO,EAAE;IACX,OAAO,OAAO;EAChB;EAEA,OAAO5B,IAAI,IAAI,OAAO;AACxB;AAAC0B,EAAA,CAtBeD,YAAY;EAAA,QAKtBnC,QAAQ;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}